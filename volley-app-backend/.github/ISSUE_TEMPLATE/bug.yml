name: üêõ Bug Report
description: Signaler un bug dans le backend
title: "[Bug] Brief description"
labels: ["bug"]
assignees: []
body:
  - type: markdown
    attributes:
      value: |
        ## Bug Report
        Utilisez le workflow Bug Finder (`.claude/skills/bug-finder/`) pour identifier la cause avant de corriger.

  - type: dropdown
    id: bounded-context
    attributes:
      label: Bounded Context Affect√©
      options:
        - club-management
        - training-management
        - match-management
        - tournament-management
        - user-management
        - shared
        - infrastructure
        - autre
    validations:
      required: true

  - type: dropdown
    id: severity
    attributes:
      label: S√©v√©rit√©
      options:
        - critical (blocker, perte de donn√©es, crash)
        - high (fonctionnalit√© majeure cass√©e)
        - medium (fonctionnalit√© mineure cass√©e)
        - low (cosm√©tique, edge case)
    validations:
      required: true

  - type: textarea
    id: description
    attributes:
      label: Description du Bug
      description: D√©crivez clairement le probl√®me observ√©
      placeholder: |
        La suppression d'un club √©choue avec une erreur 500 au lieu de supprimer le club.
    validations:
      required: true

  - type: textarea
    id: current-behavior
    attributes:
      label: Comportement Actuel
      description: Que se passe-t-il actuellement ?
      placeholder: |
        - API retourne 500 Internal Server Error
        - Message d'erreur : "Foreign key constraint failed"
        - Club non supprim√© en base de donn√©es
    validations:
      required: true

  - type: textarea
    id: expected-behavior
    attributes:
      label: Comportement Attendu
      description: Que devrait-il se passer ?
      placeholder: |
        - API retourne 204 No Content
        - Club supprim√© en base de donn√©es
        - Relations associ√©es supprim√©es (cascade) ou nettoy√©es
    validations:
      required: true

  - type: textarea
    id: steps-to-reproduce
    attributes:
      label: √âtapes pour Reproduire
      description: Comment reproduire le bug de mani√®re fiable ?
      placeholder: |
        1. Cr√©er un club avec `POST /clubs`
        2. Cr√©er une √©quipe associ√©e au club avec `POST /teams`
        3. Appeler `DELETE /clubs/{clubId}`
        4. Observer l'erreur 500
      value: |
        1.
        2.
        3.
        4.
    validations:
      required: true

  - type: textarea
    id: root-cause
    attributes:
      label: Analyse de Cause Racine (si connue)
      description: |
        Utilisez `.claude/skills/bug-finder/` pour identifier la cause.
        M√©thodologie : R√©sum√© ‚Üí Flow ‚Üí Examiner ‚Üí Top 3 Causes ‚Üí Confirmation ‚Üí Plan
      placeholder: |
        **Flow** :
        1. Controller re√ßoit DELETE /clubs/{id}
        2. DeleteClubHandler ex√©cute command
        3. ClubRepository.delete() appelle Prisma
        4. Prisma √©choue √† cause de foreign key constraint

        **Cause Racine** :
        Prisma schema ne d√©finit pas `onDelete: Cascade` pour la relation Club ‚Üí Team

  - type: textarea
    id: proposed-solution
    attributes:
      label: Solution Propos√©e
      description: Comment corriger le bug ? (si vous avez des id√©es)
      placeholder: |
        1. Mettre √† jour Prisma schema avec `onDelete: Cascade`
        2. Cr√©er migration Prisma
        3. Tester la suppression en cascade
        4. Ajouter test d'int√©gration pour cas de suppression avec relations

  - type: textarea
    id: environment
    attributes:
      label: Environnement
      description: O√π le bug se produit-il ?
      value: |
        - **Node version** :
        - **NestJS version** :
        - **Database** : PostgreSQL
        - **Environment** : dev / staging / production
    validations:
      required: true

  - type: textarea
    id: logs
    attributes:
      label: Logs / Stack Trace
      description: Incluez les logs ou stack trace pertinents
      placeholder: |
        ```
        [Nest] ERROR [ExceptionsHandler] Foreign key constraint failed
        PrismaClientKnownRequestError: Invalid `prisma.club.delete()` invocation
        ```
      render: shell

  - type: checkboxes
    id: debugging-checklist
    attributes:
      label: Debugging Checklist (√† suivre lors de la correction)
      description: Utiliser `.claude/skills/debugger/` pour le processus syst√©matique
      options:
        - label: "Define : Bug clairement d√©fini et reproductible"
        - label: "Reproduce : Bug reproductible de mani√®re fiable"
        - label: "Formulate : Hypoth√®ses formul√©es (top 3 causes possibles)"
        - label: "Prioritize : Cause la plus probable identifi√©e"
        - label: "Log : Points de logging ajout√©s pour confirmation"
        - label: "Binary Search : Cause localis√©e pr√©cis√©ment"
        - label: "Test : Tests ajout√©s pour reproduire le bug"
        - label: "Fix : Correction impl√©ment√©e"
        - label: "Verify : Fix v√©rifi√© en dev + tests"
        - label: "Protect : Tests de r√©gression ajout√©s"
